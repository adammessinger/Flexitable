!function(e,t){"use strict";function l(l,o){function n(){var e=l.cfg.use_toggle_button&&l.cfg.init_toggle_on_button_click,t=!e;l.$table.data("Flexitable")||(i(),a(t),e?C.$button.one("click",function(){b(),r().done(function(){$(!0)})}):r())}function i(){l.id||(l.id="flexitable-"+o,l.$table[0].id=l.id)}function a(e){l.cfg.use_toggle_button&&(g(),e&&b(),f(),l.$table.trigger("toggle-menu-placed.flexitable",[C,l.$toolbar]))}function r(){var t=l.$table.find("> thead th"),o=!l.cfg.lazy_column_caching&&!l.cfg.init_toggle_on_button_click;return t.length?e.deferredEach(t,s).progress(c).then(function(){o&&v(!0),l.cfg.use_toggle_button&&k.length&&(u(),p(),y(),d()),l.$table.data("Flexitable",l),l.$table.trigger("toggle-initialized.flexitable")}):void 0}function s(t,o,n){var i,a,r=e(o),s=r.data("flexitablePriorityClass"),c=l.cfg.lazy_column_caching,g=t+1,u=c&&!n?null:l.$table.find("> thead th:nth-child("+g+"), > tbody td:nth-child("+g+")");if(n)return void(k[t].$cells=u);if(s&&!c)for(i=0,a=u.length;a>i;i++)u[i].className+=" "+s;else"persist"===s&&(r[0].className+=" "+s);k[t]={is_visible:"table-cell"===r.css("display"),$th:r,heading_text:r.text(),is_persistent_col:r.hasClass("persist"),$cells:u}}function c(e,t,l){function o(){C.$button.height(C.$button.height()),C.$progress_bar.removeClass("flexitable-hidden")}function n(){C.$progress_bar.addClass("flexitable-hidden"),C.$button.removeAttr("style")}var i=Math.round(100*e)+"%",a=1===t,r=t===l;C.$progress_bar.$amount.text(i),C.$progress_bar.css("width",i),a?o():r&&n()}function g(){C.$button=e('<button type="button" />').text(l.cfg.toggle_button_txt),C.$list=e("<ul />"),C.$progress_bar=e('<div class="flexitable-toggle-progress-meter flexitable-hidden" />'),C.$progress_bar.$amount=e('<span class="flexitable-toggle-progress-amt" />'),C.$button.append(C.$progress_bar.append(C.$progress_bar.$amount)),C.append(C.$button).append(C.$list)}function u(){var t,o,n,i,a=l.id+"_toggle-col-",r=[];for(C.$list.is_populated&&C.$list.empty(),t=0,o=k.length;o>t;t++)k[t].is_persistent_col||(n=e("<input />",{type:"checkbox",name:"toggle-cols",id:a+t,value:t,"data-flexitable-id":l.id}),n.prop("checked",k[t].is_visible),i=e("<label />",{"for":a+t,text:k[t].heading_text}),r.push(e("<li />").append(n).append(i)));C.$list.append(r),C.$list.is_populated=!0}function f(){var t,o;l.$toolbar.append(C).addClass("flexitable-toolbar-has-widgets"),l.$toolbar.is_inserted||(t="after"===l.cfg.toolbar_before_or_after.toLowerCase()?"insertAfter":"insertBefore",o=l.cfg.toolbar_position_target.jquery?l.cfg.toolbar_position_target:e(l.cfg.toolbar_position_target),l.$toolbar[t](o),l.$toolbar.is_inserted=!0)}function b(){C.$button.prop("disabled",!0)}function d(){C.$button.prop("disabled",!1)}function _(){function t(e,t){var o=t.$th.data("flexitablePriorityClass"),n=l.cfg.lazy_column_caching?t.$th:t.$cells;o&&n.removeClass(o)}if(l.$table.data("Flexitable"))return C.hasClass("flexitable-menu-closed")||$(!1),b(),v(!1),e(window).add(document).off(".flexitable"),e.deferredEach(k,t).progress(function(e,t,l){c(1-e,t,l)}).then(function(){l.$toolbar.remove(),l.$table.removeData("Flexitable"),l.$table.trigger("toggle-destroyed.flexitable").off(".flexitable")})}function h(e,t,l){var o,n;return function(){var i=this,a=arguments,r=function(){o=null,l||(n=e.apply(i,a))},s=l&&!o;return clearTimeout(o),o=setTimeout(r,t),s&&(n=e.apply(i,a)),n}}function p(){C.on("click","button",function(){$(C.hasClass("flexitable-menu-closed"))}).on("change",'input[name="toggle-cols"]',function(e){x(e.target.value,e.target.checked)}),e(window).on("orientationchange.flexitable resize.flexitable",h(y,500)),e(document).on("click.flexitable",w)}function $(e){e=Boolean(e),C.toggleClass("flexitable-menu-closed",!e)}function x(e,o){if(e=parseInt(e,10),o=Boolean(o),isNaN(e))throw new Error("_toggleColumnVisibility: col_index arg is missing or a non-number");if(k[e]===t)throw new Error("_toggleColumnVisibility: col_index arg refers to a non-existent column");l.cfg.lazy_column_caching&&!k[e].$cells&&s(e,k[e].$th[0],!0),k[e].$cells.toggleClass("flexitable-cell-shown",o).toggleClass("flexitable-cell-hidden",!o),k[e].is_visible=o}function m(e,t){var l=C.$list.find("input[value="+e+"]")[0];if(t=Boolean(t),!l)throw new Error("_toggleMenuCheckbox: checkbox not found");l.checked=t}function v(e){e=Boolean(e),l.$table.toggleClass("flexitable-active",e)}function y(){var e,t,l;for(e=0,t=k.length;t>e;e++)l=k[e].is_visible,k[e].is_visible="table-cell"===k[e].$th.css("display"),l!==k[e].is_visible&&m(e,k[e].is_visible)}function w(e){C.find(e.target).length||$(!1)}var C=e('<div class="flexitable-menu flexitable-menu-closed" />'),k=[];return{init:n,destroy:_}}e.fn.flexitable=function(t){return this.each(function(o){var n=e(this),i=e.extend({toggle_columns:!0,use_toggle_button:!0,toggle_button_txt:"Columns:",init_toggle_on_button_click:!1,lazy_column_caching:!1,toolbar_position_target:n,toolbar_before_or_after:"before",destroy:!1},t||{}),a=n.data("Flexitable")||{id:n[0].id,cfg:i,$table:n,$toolbar:e('<div class="flexitable-toolbar" />')};i.toggle_columns&&!a.toggler&&(a.toggler=l(a,o)),i.destroy?a.toggler.destroy():i.toggle_columns&&a.toggler.init()})}}(jQuery),function(e,t){"use strict";function l(t){for(var l=0,o=[];t>l;l++)o.push(new e.Deferred);return o}function o(t){var l=t.length,o=e.type(t);return"function"===o||e.isWindow(t)?!1:1===t.nodeType&&l?!0:"array"===o||0===l||"number"==typeof l&&l>0&&l-1 in t}e.deferredEach=function(n,i){var a,r,s,c=0,g=n.length,u=o(n),f=new e.Deferred,b=[];if(u)a=l(g),(r=function(){g>c&&i.call(n[c],c,n[c++])!==!1&&setTimeout(r,1),a[c-1].resolve(),f.notify(c/g,c,g)})();else{for(s in n)b.push(s);a=l(b.length),r=function(){c<b.length&&i.call(n[b[c]],b[c],n[b[c++]])!==!1&&setTimeout(r,1),a[c-1].resolve(),f.notify(c/b.length,c,b.length)},r()}return e.when.apply(t,a).then(function(){var e=u?g:b.length;f.notify(1,c,e),f.resolve(n)}),f.promise()}}(jQuery);